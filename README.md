# stock-analysis
### June 29, 2022
### VBA Challenge Project

#### **Overview**
The purpose of this project was to refactor code  in VBA that would analyze different stocks and their information. Of the utmost importance is the annual return of each stock. Additionally, the volume(or amount of  stock being traded) was calculated over the year of interest. The code runs through a selection of 12 stocks that are of the client's interest for the years of 2017 and 2018.


#### **Results**
The [results](https://github.com/encollin94/stock-analysis/blob/main/VBAChallenge_2017_returns.png) for 2017 show a positive return on investments for all stocks, except for stock ticker number TERP. The [results](https://github.com/encollin94/stock-analysis/blob/main/VBAChallenge_2018_returns.png) show a majority of negative return on investments, except for ticker number RUN and ENPH. Further analysis should be done on what undustry these stocks are in and how that industry is affected by economic fluctuations. For the original code "DQ Analysis", it only ran through one stock at a time as seen in this line of code  *"If Cells(i, 1).Value = "DQ""*. Therefore, the original code would have to be written for each individual stock, which would be more time-consuming and lengthy. In the refactored code, we used arrays, *Dim tickers(12) As String"* that allowed us to create an index. In this index, we could store all the tickers and their associated volumes, starting prices, and ending prices. This allowed us  a significantly faster run time for [2017](https://github.com/encollin94/stock-analysis/blob/main/VBA_Challenge_2017.png) and [2018](https://github.com/encollin94/stock-analysis/blob/main/VBA_Challenge_2018.png). 

#### **Summary**
###### **What are the advantages and disadvantages of refactoring code?**
The adavantages of refactoring code are (1) it creates a program that runs faster, (2) it creates a code that is typically more efficient, (3) and it creates code that is repeatable, and easier to manipulate. The disadvantages of refactoring code are (1) it can be time-consuming to refactor a code for the first time (2) companies would need to have the money and resources to put into refactoring code.  Refactoring code in the real world is a short-time loss for time and money for a long-term gain on the usability, and eventually more positive financial and operative outcomes.
###### **How do these pros and cons apply to refactoring the original VBA script?**
In the "VBA stock_analysis", the pros that applied are that it certainly created a progam that ran faster. It was able to evaluate all stock of interest in less than a second, considerably faster than the original code. The code was more efficient and adabtable. In the original code, we would have had to repeat the code over and over for each individual stock.  This is considered a bad programming practice "D.R.Y. or Dont Reapeat Yourself." With the refactored, we were able to correct this bad practice.  The main con that I personally experienced is that it was time-consuming to refactor the code. I ran into multiple struggles with creating the correct arrays and how to properly use the index. However, the short-term suffering  resulted in a far better refactored code. 
